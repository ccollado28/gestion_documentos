<odoo>
    <!-- Vista para administradores -->
    <record id="view_documento_interno_form_admin" model="ir.ui.view">
        <field name="name">documento.interno.form.admin</field>
        <field name="model">documento.interno</field>
        <field name="groups_id" eval="[(4, ref('document_read_confirmation.group_documento_admin'))]"/>
        <field name="arch" type="xml">
            <form string="Documento Interno">
                <header>
                    <button name="generate_gemini_summary"
                            string="Generar Resumen con IA"
                            type="object"
                            class="oe_link"
                            help="solo de texto UTF-8"
                            modifiers='{"invisible": [["archivo", "=", false], ["summary_gemini", "!=", false]]}'/>
                </header>
                <sheet>
                    <group>
                        <field name="name"/>
                        <field name="description"/>
                        <field name="archivo" filename="filename"/>
                        <field name="filename"/>
                    </group>
                    <group string="Resumen del Documento (Generado por IA)">
                        <field name="summary_gemini"/>
                    </group>
                    <group string="Lectores">
                        <field name="required_reader_ids" widget="many2many_tags"/>
                        <field name="confirmed_reader_ids" widget="many2many_tags" readonly="1"/>
                        <field name="pending_reader_ids" widget="many2many_tags" readonly="1"/>
                    </group>
                </sheet>

                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers" readonly="1"/>
                    <field name="message_ids" widget="mail_thread" options="{'readonly': True}"/>
                </div>
            </form>
        </field>
    </record>
<!--    vista tree para admin-->
    <record id="documento_interno_view_tree_admin" model="ir.ui.view">
        <field name="name">documento.interno.tree.admin</field>
        <field name="model">documento.interno</field>
        <field name="groups_id" eval="[(4, ref('document_read_confirmation.group_documento_admin'))]"/>
        <field name="arch" type="xml">
            <tree string="Documentos Internos" decoration-danger="tiene_lectores_pendientes">
                <field name="name"/>
                <field name="filename" string="Archivo"/>
                <field name="fecha_publicacion"/>
                <field name="pending_reader_ids"/>
                <field name="tiene_lectores_pendientes" string="" class="o_hidden"/>
                <field name="description" optional="hide"/>
            </tree>
        </field>
    </record>

    <!--  vista form para usuarios que no estan en el grupo de administradores      -->
    <record id="view_documento_interno_form_lectura" model="ir.ui.view">
        <field name="name">documento.interno.form.lectura</field>
        <field name="model">documento.interno</field>
        <field name="arch" type="xml">
            <form string="Confirmar Lectura del Documento">
                <header>
                    <button name="confirmar_lectura"
                            string="Confirmar Lectura"
                            type="object"
                            class="oe_highlight"
                            modifiers='{"invisible": [["is_read_by_current_user", "=", true]]}'/>
                </header>
                <sheet>
                    <group>
                        <field name="name" readonly="1" string="Título del Documento"/>
                        <field name="description" readonly="1" string="Descripción"/>
                        <field name="fecha_publicacion" readonly="1"/>
                        <field name="archivo" filename="filename" readonly="1" string="Archivo Adjunto"/>
                    </group>
                    <group string="Resumen del Documento (Generado por IA)">
                        <field name="summary_gemini" readonly="1"/>
                    </group>
                    <group>
                        <field name="is_read_by_current_user" widget="boolean_toggle" readonly="1" string="Leído"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <!--  vista tree para usuarios que no estan en el grupo de administradores      -->
    <record id="view_documento_interno_tree" model="ir.ui.view">
        <field name="name">documento.interno.tree</field>
        <field name="model">documento.interno</field>
        <field name="arch" type="xml">
            <tree string="Documentos Internos" decoration-success="is_read_by_current_user">
                <field name="name"/>
                <field name="description"/>
                <field name="fecha_publicacion"/>
                <field name="is_read_by_current_user" invisible="1"/>
            </tree>
        </field>
    </record>
</odoo>
